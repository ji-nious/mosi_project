<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>여행 상품 목록</title>
  <link rel="stylesheet" th:href="@{/css/layout.css}">
  <link rel="stylesheet" th:href="@{/css/common.css}">
  <link rel="stylesheet" th:href="@{/css/product/product_list.css}">
</head>

<body>
  <header th:replace="~{fragments/header :: header}"></header>
  <div class="page-container">
    <div class="breadcrumb">
      <span>홈 &gt; 테마여행 &gt;
        <span th:if="${productList.product?.category == 'area'}">지역</span>
        <span th:if="${productList.product.category == 'pet'}">반려동물</span>
        <span th:if="${productList.product.category == 'restaurant'}">맛집</span>
        <span th:if="${productList.product.category == 'culture_history'}">문화/역사</span>
        <span th:if="${productList.product.category == 'season_nature'}">계절/자연</span>
        <span th:if="${productList.product.category == 'silver_disables'}">실버/교통약자</span>
        <span th:if="${!(productList.product.category == 'area'
                          or productList.product.category == 'pet'
                          or productList.product.category == 'restaurant'
                          or productList.product.category == 'culture_history'
                          or productList.product.category == 'season_nature'
                          or productList.product.category == 'silver_disables')}"
        >전체</span>
      </span>
    </div>
    <!--카테고리명-->
    <section class="category-header">
      <h1>카테고리명</h1>
    </section>

    <!--가장 인기있는 키워드-->
    <section class="top-keywords-frame">
      <div class="top-keywords-header">
        <span class="top-keywords-title">가장 인기있는 키워드 Top5</span>
        <span class="hot-badge">Hot</span>
      </div>

      <!-- 키워드 카드 리스트 -->
      <div class="keyword-cards">
        <!-- 카드 #1 -->
        <div class="keyword-card">
          <div class="keyword-content">
            <div class="keyword-icon" style="background-image: url('../../static/img/product/product_list/반려견.png');">
            </div>
            <span class="keyword-label">반려견</span>
          </div>
          <!-- 필요 시 카드 내 Hot 배지 -->
          <!-- <span class="hot-badge">Hot</span> -->
        </div>

        <!-- 카드 #2 -->
        <div class="keyword-card">
          <div class="keyword-content">
            <div class="keyword-icon" style="background-image: url('../../static/img/product/product_list/맛집.png');">
            </div>
            <span class="keyword-label">맛집</span>
          </div>
        </div>

        <!-- 카드 #3 -->
        <div class="keyword-card">
          <div class="keyword-content">
            <div class="keyword-icon" style="background-image: url('../../static/img/product/product_list/바다.png');">
            </div>
            <span class="keyword-label">바다</span>
          </div>
        </div>

        <!-- 카드 #4 -->
        <div class="keyword-card">
          <div class="keyword-content">
            <div class="keyword-icon" style="background-image: url('../../static/img/product/product_list/카페.png');">
            </div>
            <span class="keyword-label">카페</span>
          </div>
        </div>

        <!-- 카드 #5 -->
        <div class="keyword-card">
          <div class="keyword-content">
            <div class="keyword-icon" style="background-image: url('../../static/img/product/product_list/연인.png');">
            </div>
            <span class="keyword-label">연인</span>
          </div>
        </div>
      </div>
    </section>

    <div class="content-wrapper">
      <aside class="sidebar">
        <div class="guide-box">
          <ul>
            <li>탑 글래스 여행가이드</li>
            <li>모시에서 만나보세요!</li>
          </ul>
        </div>
        <div class="menu-frame">
          <ul>
            <li><a th:href="@{product/list}">지역</a></li>
            <li><a href="#">반려동물</a></li>
            <li><a href="#">맛집</a></li>
            <li><a href="#">문화</a></li>
            <li><a href="#">역사</a></li>
            <li><a href="#">계절</a></li>
            <li><a href="#">자연</a></li>
            <li><a href="#">실버</a></li>
            <li><a href="#">교통약자</a></li>
          </ul>
        </div>
      </aside>

      <!--main-->
      <main class="main-content">
        <form class="filter-form">
          <div class="select-container">
            <!-- 카테고리 선택 -->
            <div class="filter-item filter-category">
              <select class="filter-select filter-category">
                <option value="" disabled selected>카테고리 선택</option>
                <option value="theme1">테마여행1</option>
                <option value="theme2">테마여행2</option>
                <!-- … -->
              </select>
            </div>

            <!-- 가이드 동반 -->
            <div class="filter-item filter-guide">
              <select class="filter-select filter-guide">
                <option value="" disabled selected>가이드 동반</option>
                <option value="yes">동반 O</option>
                <option value="no">동반 X</option>
              </select>
            </div>

            <!-- 상태 (판매중) -->
            <div class="filter-item filter-status">
              <select class="filter-select filter-status">
                <option value="" disabled selected>판매 상태</option>
                <option value="on">판매중</option>
                <option value="off">판매 종료</option>
              </select>
            </div>

            <!-- 인원 수 -->
            <div class="filter-item filter-people">
              <select class="filter-select filter-people">
                <option value="" disabled selected>인원 수</option>
                <option value="1">1명</option>
                <option value="2">2명</option>
                <option value="3">3명</option>
                <!-- … -->
              </select>
            </div>

            <!-- 추천 연령 -->
            <div class="filter-item filter-age">
              <select class="filter-select filter-age">
                <option value="" disabled selected>추천 연령</option>
                <option value="20s">20대</option>
                <option value="30s">30대</option>
                <option value="40s">40대</option>
                <!-- … -->
              </select>
            </div>

            <!-- 여행 기간 -->
            <div class="filter-item filter-duration">
              <select class="filter-select filter-duration">
                <option value="" disabled selected>여행 기간</option>
                <option value="1-2">1~2일</option>
                <option value="3-4">3~4일</option>
                <option value="5+">5일 이상</option>
              </select>
            </div>

            <!-- 숙박 포함 -->
            <div class="filter-item filter-accommodation">
              <select class="filter-select filter-accommodation">
                <option value="" disabled selected>숙박 포함</option>
                <option value="yes">포함</option>
                <option value="no">미포함</option>
              </select>
            </div>

            <!-- 교통편 -->
            <div class="filter-item filter-transport">
              <select class="filter-select filter-transport">
                <option value="" disabled selected>교통편</option>
                <option value="bus">버스</option>
                <option value="train">기차</option>
                <option value="plane">비행기</option>
              </select>
            </div>

            <!-- 여행 경비 -->
            <div class="filter-item filter-budget">
              <select class="filter-select filter-budget">
                <option value="" disabled selected>여행 경비</option>
                <option value="under500">50만 이하</option>
                <option value="500-1000">50~100만</option>
                <option value="1000+">100만 이상</option>
              </select>
            </div>

            <!-- 상품 가격 -->
            <div class="filter-item filter-price">
              <select class="filter-select filter-price">
                <option value="" disabled selected>상품 가격</option>
                <option value="under100">100만 이하</option>
                <option value="100-200">100~200만</option>
                <option value="200+">200만 이상</option>
              </select>
            </div>

            <!-- 등록 일자 -->
            <div class="filter-item filter-date">
              <select class="filter-select filter-date">
                <option value="" disabled selected>등록 일자</option>
                <option value="1day">오늘</option>
                <option value="7day">최근 7일</option>
                <option value="30day">최근 30일</option>
              </select>
            </div>
          </div>
          <div class="keyword-container">
            <!-- 키워드 입력 -->
            <div class="filter-item filter-keywords">
              <input type="text" class="keyword-input" name="keywords" placeholder="키워드를 추가해 보세요. ex) #연인 #우정 #만두" />
            </div>
          </div>
          <div class="formButton-container">
            <div class="filter-example">
              실버, 가이드 동반 O, 4명, 70대, 판매중, 3박 4일, 200만원,
            </div>
            <!-- 검색 버튼 -->
            <div class="filter-item filter-search">
              <button type="submit" class="btn-search">검색</button>
            </div>
          </div>
        </form>


        <!--리스트 갯수-->
        <div class="service-controls">
          <div class="service-count">
            <p>3,501개의 서비스</p>
          </div>
          <div class="custom-dropdown">
            <button type="button" class="dropdown-toggle">
              <span class="selected-label">인기순</span>
              <img src="/static/img/product/product_list/arrow-down.png" class="arrow-icon" alt="">
            </button>
            <ul class="dropdown-menu">
              <li>
                <label>
                  <input type="radio" name="sort" value="popular" checked>
                  <span class="radio-img"></span>
                  인기순
                </label>
              </li>
              <li>
                <label>
                  <input type="radio" name="sort" value="recommend">
                  <span class="radio-img"></span>
                  추천순
                </label>
              </li>
              <li>
                <label>
                  <input type="radio" name="sort" value="recommend">
                  <span class="radio-img"></span>
                  신규등록순
                </label>
              </li>
              <li>
                <label>
                  <input type="radio" name="sort" value="recommend">
                  <span class="radio-img"></span>
                  등록리뷰순
                </label>
              </li>
              <li>
                <label>
                  <input type="radio" name="sort" value="recommend">
                  <span class="radio-img"></span>
                  평점순
                </label>
              </li>
              <li>
                <label>
                  <input type="radio" name="sort" value="recommend">
                  <span class="radio-img"></span>
                  판매순
                </label>
              </li>
            </ul>
          </div>
        </div>
        <!--상품리스트-->
        <div class="product-list">
          <div class="product-item" th:each="form : ${productManagingForms}">
            <!-- 썸네일 이미지 -->
            <img th:if="${form.images != null and #lists.size(form.images) > 0}"
                 th:src="${form.images[0].base64ImageData}"
                 th:alt="${form.images[0].fileName}"/>
            <img th:if="${form.images == null or #lists.isEmpty(form.images)}"
                 th:src="@{/img/default-product.png}" alt="기본 상품 이미지" />
            <div class="product-info">
              <div class="product-info-left">
                <h2><a th:href="@{/product/view/{id}(id=${form.product.productId})}" th:text="${form.product.title}">상품명</a></h2>
                <div class="product-info-left-detail">

                  <select class="status-select" th:data-product-id="${form.product.productId}" th:value="${form.product.status}">
                    <option value="판매중" th:selected="${form.product.status == '판매중'}">판매중</option>
                    <option value="판매대기" th:selected="${form.product.status == '판매대기'}">판매대기</option>
                  </select>

                  <div class="product-info-left-detail-details">
                    <div th:if="${form.product.updateDate == null or form.product.createDate == form.product.updateDate}"
                         th:text="${#dates.format(form.product.createDate, 'yyyy-MM-dd')}">
                    </div>
                    <div th:if="${form.product.updateDate != null and form.product.createDate != form.product.updateDate}"
                         th:text="${#dates.format(form.product.updateDate, 'yyyy-MM-dd')}">
                    </div>
                    <div>조회수</div>
                    <div>좋아요</div>
                    <div>댓글수</div>
                  </div>
                </div>
                <span class="text-trim" th:text="${form.product.description}"></span>
              </div>
            </div>
            <div class="product-info-right">
              <div class="product-info-right-detail">
                <div>0% 저렴</div>
                <div class="price">
                  <h1 th:text="|${#numbers.formatDecimal(form.product.salesPrice, 0, 'COMMA', 0, 'POINT')}|">40,000</h1>
                  <div>원</div>
                </div>
                <div th:text="|정가 ${#numbers.formatDecimal(form.product.normalPrice, 0, 'COMMA', 0, 'POINT')}원|"></div>
              </div>
              <div class="btn-group">
                <button id="update-btn" class="btn-group-edit">수정</button>
                <button id="delete-btn" class="btn-group-delete">삭제</button>
              </div>
            </div>
          </div>
          <hr>
        </div>
        <div class="pagination">
          <a th:if="${currentPage > 1}"
             th:href="@{/product/manage(page=${currentPage - 1}, size=${5}, status=${selectedStatus})}">이전</a>

          <span th:text="${currentPage} + ' / ' + ${totalPages}"></span>

          <a th:if="${currentPage < totalPages}"
             th:href="@{/product/manage(page=${currentPage + 1}, size=${5}, status=${selectedStatus})}">다음</a>
        </div>
      </main>
    </div>

    <!--공지-->
    <section class="notice-frame">
      <span class="notice-title">공지</span>
      <span class="notice-text">
        &lt;하나LIVE&gt;25년 6월 1일 방송 - 동유럽 구매 인증 이벤트 당첨자 안내
      </span>
      <a href="#" class="notice-more">+ 더보기</a>
    </section>

  </div>
  <footer th:replace="~{fragments/footer :: footer}"></footer>
</body>
<script>
  document.querySelectorAll('.custom-dropdown').forEach(dropdown => {
    const btn = dropdown.querySelector('.dropdown-toggle');
    const labelSpan = btn.querySelector('.selected-label');   // ← 이제 null 아님

    // 토글 열기/닫기
    btn.addEventListener('click', e => {
      e.stopPropagation();               // 열자마자 닫히는 현상 방지
      dropdown.classList.toggle('open');
    });

    // 옵션 클릭 → 레이블 교체 + 자동 닫기
    dropdown.querySelectorAll('input[type="radio"]').forEach(radio => {
      radio.addEventListener('change', () => {
        labelSpan.textContent = radio.parentElement.textContent.trim();
        dropdown.classList.remove('open');
      });
    });
  });

  // 바깥 클릭 시 닫기
  document.addEventListener('click', e => {
    document.querySelectorAll('.custom-dropdown.open').forEach(d => {
      if (!d.contains(e.target)) d.classList.remove('open');
    });
  });
  document.addEventListener('click', e => {
    if (e.target.classList.contains('btn-like')) {
      e.target.classList.toggle('is-active');
    }
  });
</script>
</html>

