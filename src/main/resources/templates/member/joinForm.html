<!-- /templates/member/joinForm.html -->
<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>회원가입</title>
    <link rel="stylesheet" th:href="@{/css/member/joinForm.css}">
    <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
</head>
<body>
    <div style="width:100%;text-align:left;padding:16px 0 0 24px;position:fixed;top:0;left:0;z-index:2000;background:transparent;">
        <a href="/" style="display:inline-block;text-decoration:none;">
            <span style="font-size:28px;font-weight:bold;color:#222;letter-spacing:2px;">MO:SI</span>
        </a>
    </div>

    <div class="register-container">
        <h2>MO:SI 계정 생성</h2>
        <div class="subtitle">
            하나의 MO:SI 계정으로 모든 서비스를 이용할 수 있습니다.<br>
            이미 계정이 있으신가요?
            <a th:href="@{/login}" style="color:#0099ad;font-weight:600;">로그인</a>
        </div>

        <!-- ✅ onsubmit 추가됨 -->
        <form th:action="@{/members/join}" th:object="${form}" method="post" enctype="multipart/form-data" onsubmit="return validateForm()">

            <div th:if="${#fields.hasGlobalErrors()}" class="error global-error">
                <p th:each="err : ${#fields.globalErrors()}" th:text="${err.defaultMessage}"></p>
            </div>

            <!-- 이메일 -->
            <div class="form-group">
                <label for="email">이메일<span class="required">*</span></label>
                <div style="display:flex; gap:8px; align-items:center;">
                    <input type="email" th:field="*{email}" id="email" class="input-mosi" placeholder="name@example.com" required style="flex:1;">
                    <button type="button" class="btn-small" onclick="checkEmail()">중복 확인</button>
                </div>
                <!-- ✅ 중복 확인 메시지 출력 영역 추가 -->
                <div id="emailCheckResult" class="email-result"></div>
                <div th:if="${#fields.hasErrors('email')}" th:errors="*{email}" class="error"></div>
            </div>

            <!-- 비밀번호 -->
            <div class="form-group">
                <label for="passwd">비밀번호<span class="required">*</span></label>
                <input type="password" th:field="*{passwd}" id="passwd" class="input-mosi" placeholder="암호" required>
                <div th:if="${#fields.hasErrors('passwd')}" th:errors="*{passwd}" class="error"></div>
            </div>

            <!-- 비밀번호 확인 -->
            <div class="form-group">
                <label for="confirmPasswd">비밀번호 확인<span class="required">*</span></label>
                <input type="password" th:field="*{confirmPasswd}" id="confirmPasswd" class="input-mosi" placeholder="암호 재입력" required>
                <div th:if="${#fields.hasErrors('confirmPasswd')}" th:errors="*{confirmPasswd}" class="error"></div>
            </div>

            <!-- 이름 + 성별 -->
            <div class="form-group row">
                <div>
                    <label for="name">이름<span class="required">*</span></label>
                    <input type="text" th:field="*{name}" id="name" class="input-mosi" placeholder="이름" required>
                    <div th:if="${#fields.hasErrors('name')}" th:errors="*{name}" class="error"></div>
                </div>
                <div>
                    <label>성별</label>
                    <div class="gender-options">
                        <!-- ✅ 중복 ID 제거 -->
                        <label for="gender-male">
                            <input type="radio" th:field="*{gender}" id="gender-male" value="남자"> 남
                        </label>
                        <label for="gender-female">
                            <input type="radio" th:field="*{gender}" id="gender-female" value="여자"> 여
                        </label>
                    </div>
                    <div th:if="${#fields.hasErrors('gender')}" th:errors="*{gender}" class="error"></div>
                </div>
            </div>

            <!-- 닉네임 -->
            <div class="form-group">
                <label for="nickname">닉네임<span class="required">*</span></label>
                <input type="text" th:field="*{nickname}" id="nickname" class="input-mosi" placeholder="닉네임" required>
                <div th:if="${#fields.hasErrors('nickname')}" th:errors="*{nickname}" class="error"></div>
            </div>

            <!-- 전화번호 -->
            <div class="form-group">
                <label for="tel">전화번호<span class="required">*</span></label>
                <input type="tel" th:field="*{tel}" id="tel" class="input-mosi" placeholder="예: 010-1234-5678" required>
                <div th:if="${#fields.hasErrors('tel')}" th:errors="*{tel}" class="error"></div>
            </div>

            <hr class="section-divider">

            <!-- 주소 -->
            <div class="form-group">
                <label class="address-desc" for="address">주소</label>
                <input type="text" th:field="*{address}" id="address" class="input-mosi" placeholder="기본주소 + 상세주소" />
            </div>

            <!-- 생년월일 -->
            <div class="form-group">
                <label for="birthDate">생년월일</label>
                <input type="date" th:field="*{birthDate}" id="birthDate" class="input-mosi">
            </div>

            <!-- 프로필 사진 -->
            <div class="form-group">
                <label for="picFile">프로필 이미지</label>
                <input type="file" th:field="*{picFile}" id="picFile" class="input-mosi">
            </div>

            <!-- 버튼 -->
            <div class="btn-wrapper">
                <button type="submit" class="btn" id="register-btn">계정 생성</button>
            </div>
        </form>

        <!-- 토스트 메시지 -->
        <div id="toast" class="toast-message" style="display: none;"></div>
    </div>

    <script th:src="@{/js/member/joinForm.js}"></script>
</body>
</html>
